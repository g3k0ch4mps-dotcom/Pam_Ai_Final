# Pamilo Business AI API Reference
Version: 1.0.0  
Base URL: `http://localhost:3000/api`

---

## üîê Authentication
This API uses **JSON Web Tokens (JWT)** for authorization.
- Token should be included in the header as: `Authorization: Bearer <your_token> `

---

## üë• Authentication Endpoints

### 1. Register Business & Owner
Create a new business and an admin user account.
- **URL**: `/auth/register`
- **Method**: `POST`
- **Auth Required**: ‚ùå No
- **Body** (JSON):
    | Field | Type | Required | Description |
    | :--- | :--- | :--- | :--- |
    | `email` | `string` | Yes | Valid email address |
    | `password` | `string` | Yes | Min 8 characters |
    | `firstName` | `string` | Yes | User's first name |
    | `lastName` | `string` | Yes | User's last name |
    | `businessName`| `string` | Yes | Name of the business |
    | `industry` | `string` | No | Industry type |

### 2. User Login
Authenticate and receive a JWT.
- **URL**: `/auth/login`
- **Method**: `POST`
- **Auth Required**: ‚ùå No
- **Body** (JSON): `{"email": "...", "password": "..."}`
- **Success Response**:
  ```json
  {
    "success": true,
    "token": "JWT_TOKEN_HERE",
    "user": { "id": "...", "email": "..."},
    "business": { "id": "...", "slug": "..." }
  }
  ```

---

## üè¢ Business Management

### 3. Get Private Profile
Retrieves full business details.
- **URL**: `/business/:id/profile`
- **Method**: `GET`
- **Auth Required**: ‚úÖ Yes (`Authorization: Bearer <token>`)
- **Permission**: Business Member

### 4. Update Settings
Modify branding and chat behavior.
- **URL**: `/business/:id/settings`
- **Method**: `PUT`
- **Auth Required**: ‚úÖ Yes (`Authorization: Bearer <token>`)
- **Permission**: Owner
- **Body** (Partial Update):
  ```json
  {
    "chatSettings": { "isPublic": true, "welcomeMessage": "Hello!" },
    "branding": { "primaryColor": "#0000FF" }
  }
  ```

---

## üìÑ Document Processing

### 5. Upload Knowledge Base
Upload a PDF, DOCX, or TXT file for RAG.
- **URL**: `/documents/upload`
- **Method**: `POST`
- **Auth Required**: ‚úÖ Yes (`Authorization: Bearer <token>`)
- **Body**: `form-data`
    - `document`: File (max 5MB)

### 6. List Documents
- **URL**: `/documents`
- **Method**: `GET`
- **Auth Required**: ‚úÖ Yes (`Authorization: Bearer <token>`)

---

## üí¨ AI Chat (RAG)

### 7. Public Chat Interaction
The main endpoint for the customer-facing chat widget.
- **URL**: `/chat/public`
- **Method**: `POST`
- **Auth Required**: ‚ùå No (Rate limited by IP)
- **Rate Limit**: 20 requests / 15 mins
- **Body** (JSON):
    | Field | Type | Required | Description |
    | :--- | :--- | :--- | :--- |
    | `businessSlug`| `string` | Yes | The URL-friendly business name |
    | `question` | `string` | Yes | The user's query |

- **Response**:
  ```json
  {
    "success": true,
    "answer": "Generated AI response based on documents.",
    "provider": "openai | gemini"
  }
  ```

---

## ‚ö†Ô∏è Error Codes

| Code | HTTP Status | Description |
| :--- | :--- | :--- |
| `UNAUTHORIZED` | 401 | Invalid or missing JWT token |
| `FORBIDDEN` | 403 | Authenticated user lacks permission |
| `BUSINESS_NOT_FOUND` | 404 | Business ID or Slug does not exist |
| `RATE_LIMIT_EXCEEDED` | 429 | Too many requests from your IP |
| `SERVER_ERROR` | 500 | Internal server crash or external API failure |

---
*Generated by Pamilo Backend Team*
