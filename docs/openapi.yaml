openapi: 3.0.3
info:
  title: Business AI Assistant API
  description: |
    API for Business AI Assistant platform.
    Features:
    - AI Chat with RAG
    - Document Management
    - Lead Capture & Scoring
    - Multi-tenant Business Management
  version: 1.0.0
  contact:
    name: API Support
    email: support@pam-ai.com
servers:
  - url: https://pam-ai-backend.onrender.com
    description: Production Server
  - url: http://localhost:3000
    description: Local Development
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    User:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
          format: email
        businessId:
          type: string
    Business:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        slug:
          type: string
    Error:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            code:
              type: string
            message:
              type: string
paths:
  /api/health:
    get:
      summary: Check API Health
      responses:
        '200':
          description: API is healthy
  /api/auth/register:
    post:
      summary: Register new business
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [email, password, businessName]
              properties:
                email: {type: string}
                password: {type: string}
                businessName: {type: string}
                firstName: {type: string}
                lastName: {type: string}
      responses:
        '201':
          description: Registration successful
  /api/auth/login:
    post:
      summary: User Login
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email: {type: string}
                password: {type: string}
      responses:
        '200':
          description: Login successful
  /api/business/public/{slug}:
    get:
      summary: Get public business info
      parameters:
        - name: slug
          in: path
          required: true
          schema: {type: string}
      responses:
        '200':
          description: Success
  /api/documents/upload:
    post:
      summary: Upload Document
      security: [{bearerAuth: []}]
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                document: {type: string, format: binary}
      responses:
        '201':
          description: Upload successful
  /api/documents/add-url:
    post:
      summary: Scrape URL
      security: [{bearerAuth: []}]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url: {type: string}
      responses:
        '200':
          description: Scraping started
  /api/chat/public/{businessSlug}:
    post:
      summary: Public Chat Message
      parameters:
        - name: businessSlug
          in: path
          required: true
          schema: {type: string}
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                message: {type: string}
                history: {type: array, items: {type: object}}
      responses:
        '200':
          description: AI Response
